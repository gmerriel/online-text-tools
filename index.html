<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Sentence Split & Clean</title>
  <style>
    :root { --bg:#0b0c10; --card:#111318; --muted:#97a0ad; --text:#e7ebf3; --accent:#4da3ff; }
    * { box-sizing: border-box; }
    body { margin:0; font:16px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; background:var(--bg); color:var(--text); }
    .wrap { max-width:1100px; margin:32px auto; padding:0 16px; }
    .header { display:flex; gap:12px; flex-wrap:wrap; align-items:center; justify-content:space-between; margin-bottom:12px; }
    .title { font-weight:700; letter-spacing:.2px; }
    .muted { color:var(--muted); font-size:14px; }
    .card { background:var(--card); border:1px solid #1a1d24; border-radius:14px; padding:14px; }
    .grid { display:grid; grid-template-columns:1fr; gap:14px; }
    @media (min-width:900px){ .grid { grid-template-columns:1fr 1fr; } }
    textarea { width:100%; min-height:420px; resize:vertical; background:#0e1016; color:var(--text); border:1px solid #20232b; border-radius:10px; padding:12px 12px 44px; outline:none; }
    .controls { display:flex; gap:10px; flex-wrap:wrap; align-items:center; }
    .btn { border:1px solid #20232b; background:#141822; color:var(--text); padding:10px 14px; border-radius:10px; cursor:pointer; }
    .btn:hover { border-color:#2b3340; }
    .btn.primary { background:var(--accent); color:#00142a; border-color:transparent; font-weight:700; }
    .btn.ghost { background:transparent; }
    .row { display:flex; align-items:center; justify-content:space-between; gap:10px; }
    label { display:flex; align-items:center; gap:8px; font-size:14px; color:var(--muted); cursor:pointer; }
    .footer { margin-top:8px; font-size:12px; color:var(--muted); text-align:right; }
    .hint { font-size:12px; color:var(--muted); margin-top:-6px; }
    .toolbar { display:flex; flex-wrap:wrap; gap:8px; margin-top:12px; position:relative; z-index:1; }
    .toolbar .btn { padding:8px 10px; font-size:13px; }
    #output { margin-bottom: 12px; }   /* space above the toolbar */
    .hr { height:1px; background:#1a1d24; margin:10px 0; flex-basis:100%; }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="header">
      <div>
        <div class="title">Sentence Split & Clean</div>
        <div class="muted">Paste anything → plain text → one sentence per line → blank line between.</div>
      </div>
      <div class="controls">
        <button id="convert" class="btn primary">Convert</button>
        <button id="copy" class="btn">Copy</button>
        <button id="download" class="btn">Download .txt</button>
        <button id="clear" class="btn ghost">Clear</button>
      </div>
    </div>

    <div class="grid">
      <div class="card">
        <div class="row" style="margin-bottom:6px">
          <div class="muted">Input</div>
          <label><input type="checkbox" id="stripHtml" checked /> Strip HTML/styling automatically</label>
        </div>
        <textarea id="input" placeholder="Paste rich text, HTML, Google Docs/Word content, transcripts, etc."></textarea>
        <div class="hint">Tip: leave “Strip HTML” on if you paste from Docs/Word/emails.</div>
      </div>

      <div class="card">
        <div class="row" style="margin-bottom:6px">
          <div class="muted">Output</div>
          <div id="stats" class="muted">Characters: 0 | Words: 0 | Sentences: 0 | Lines: 0</div>
        </div>
        <label style="display:flex;align-items:center;gap:8px;margin-bottom:6px;">
          <input type="checkbox" id="live" checked /> Live as you type
        </label>
        <textarea id="output" placeholder="Your cleaned, sentence-per-line text will appear here." readonly></textarea>

        <!-- Tools -->
        <div class="toolbar">
          <!-- Case conversion -->
          <button class="btn" id="case-sentence">Sentence case</button>
          <button class="btn" id="case-lower">lower case</button>
          <button class="btn" id="case-upper">UPPER CASE</button>
          <button class="btn" id="case-capitalized">Capitalized Case</button>
          <button class="btn" id="case-title">Title Case</button>
          <button class="btn" id="case-ap-title">AP title case – Google Ads</button>
          <button class="btn" id="case-alternating">aLtErNaTiNg cAsE</button>
          <button class="btn" id="case-inverse">Inverse Case</button>

          <div class="hr"></div>

          <!-- Dialect -->
          <button class="btn" id="dialect-us">Convert to English (US)</button>
          <button class="btn" id="dialect-uk">Convert to English (UK)</button>
        </div>

        <div class="hint">Adds an empty line between sentences by design. Tools change the output in-place.</div>
      </div>
    </div>

    <div class="footer">Built with vanilla JS. Uses <code>Intl.Segmenter</code> for accurate sentence splitting when available.</div>
  </div>

  <script>
    const $ = sel => document.querySelector(sel);
    const inputEl = $('#input');
    const outputEl = $('#output');
    const stripHtmlEl = $('#stripHtml');
    const liveEl = $('#live');
    const statsEl = $('#stats');

    // --- Preserve acronyms / initialisms (extendable) ---
    const ACRONYMS = new Set([
      'AI','USA','US','UK','EU','U.S.','U.K.','NATO','FBI','CIA','HR','CEO','CFO','CTO','CRM','API','SMS','SEO','SEM','PDF','HTML','CSS'
    ]);

    const COMMON_ABBR = [
      "Mr.", "Mrs.", "Ms.", "Dr.", "Prof.", "Sr.", "Jr.", "St.", "Mt.",
      "vs.", "etc.", "e.g.", "i.e.", "a.m.", "p.m.", "U.S.", "U.K.", "No."
    ];
    const ABBR_PLACEHOLDER = "\uE000"; // private-use char

    function detectHtml(s) { return /<\/?[a-z][\s\S]*>/i.test(s); }
    function preNormalizeWhitespace(s) {
      return s.replace(/\r\n?/g, "\n").replace(/[ \t]+\n/g, "\n").replace(/\u00A0/g, ' ');
    }
    function stripHtmlToText(s) {
      s = s.replace(/<\s*br\s*\/?>/gi, "\n");
      s = s.replace(/<\/\s*(p|div|li|h[1-6]|blockquote|tr)\s*>/gi, "\n");
      s = s.replace(/<style[\s\S]*?<\/style>/gi, "")
           .replace(/<script[\s\S]*?<\/script>/gi, "")
           .replace(/<[^>]+>/g, "");
      return s;
    }
    function protectAbbreviations(text) {
      let out = text;
      COMMON_ABBR.forEach(abbr => {
        const safe = abbr.replace(/\./g, ABBR_PLACEHOLDER);
        const re = new RegExp(abbr.replace('.', '\\.'), 'g');
        out = out.replace(re, safe);
      });
      return out;
    }
    function restoreAbbreviations(text) {
      return text.replace(new RegExp(ABBR_PLACEHOLDER, 'g'), '.');
    }
    function normalizeInternalSpaces(s) {
      return s.replace(/[ \t]{2,}/g, ' ').replace(/\n{3,}/g, "\n\n").trim();
    }
    function restoreAcronyms(text){
      ACRONYMS.forEach(acr=>{
        const re = new RegExp(`\\b${acr.replace(/\./g,'\\.')}\\b`,'gi');
        text = text.replace(re, acr);
      });
      return text;
    }

    // Robust sentence splitter: punctuation OR any newline becomes a boundary; ellipses end sentences.
    function splitIntoSentences(text) {
      const ELLIP = "\uE001";  // ellipsis placeholder
      const MARK  = "\u241E";  // split marker

      let t = text
        .replace(/\u2026/g, "...")   // convert unicode ellipsis
        .replace(/\.{3,}/g, ELLIP);  // protect any 3+ dots as one token

      // AFTER punctuation (. ! ?) and AFTER ellipses
      t = t.replace(/([.!?]+["”’)\]]*)(?=\s|$)/g, `$1${MARK}`);
      t = t.replace(new RegExp(ELLIP + '(?=\\s|$)', 'g'), ELLIP + MARK);

      // Any newline(s) are also boundaries
      t = t.replace(/\n+/g, MARK);

      return t
        .split(MARK)
        .map(s => s.trim())
        .filter(Boolean)
        .map(s => s.replace(new RegExp(ELLIP, 'g'), '...'));
    }

    function updateStats(text) {
      const charCount = text.length;
      const wordCount = text.trim() ? text.trim().split(/\s+/).filter(Boolean).length : 0;
      const sentenceCount = text.trim() ? text.split(/\n\s*\n/).filter(Boolean).length : 0;
      const lineCount = text ? text.split(/\n/).filter(l => l.length > 0).length : 0;
      statsEl.textContent = `Characters: ${charCount} | Words: ${wordCount} | Sentences: ${sentenceCount} | Lines: ${lineCount}`;
    }

    function convert() {
      let raw = inputEl.value || "";
      if (!raw.trim()) { outputEl.value = ""; updateStats(""); return; }

      let text = preNormalizeWhitespace(raw);
      if (stripHtmlEl.checked && detectHtml(text)) text = stripHtmlToText(text);
      text = text.replace(/[ \t]{2,}/g, ' ').replace(/\n{2,}/g, "\n");

      const sentences = splitIntoSentences(text);
      const cleaned = sentences.map(s => normalizeInternalSpaces(s.replace(/\s*\n\s*/g, ' ').trim()));
      let out = cleaned.join("\n\n") + "\n";
      out = restoreAcronyms(out); // keep AI, USA, etc.
      outputEl.value = out;
      updateStats(out);
    }

    // Live mode ON by default + run once on load if input has text
    liveEl.checked = true;
    if (inputEl.value && inputEl.value.trim()) convert();

    // ---- Case conversion helpers (operate on OUTPUT text; preserve blank lines) ----
    function transformOutput(fn) {
      ensureOutputFilled(); // <-- auto-fill output from input if empty
      const outputEl = $('#output');
      const newText = fn(outputEl.value || "");
      outputEl.value = restoreAcronyms(newText);
      updateStats(outputEl.value);
    }

    function toLower(text) { return text.toLowerCase(); }
    function toUpper(text) { return text.toUpperCase(); }
    function toInverse(text) {
      return text.replace(/[a-zA-Z]/g, ch => ch === ch.toLowerCase() ? ch.toUpperCase() : ch.toLowerCase());
    }
    function toAlternating(text) {
      let toggle = true;
      return text.split('').map(ch => {
        if (/[a-zA-Z]/.test(ch)) {
          const out = toggle ? ch.toLowerCase() : ch.toUpperCase();
          toggle = !toggle;
          return out;
        }
        return ch;
      }).join('');
    }

    // Capitalize after opening quotes/brackets; preserve acronyms
    function sentenceCapLine(line){
      const m = line.match(/^(\s*["“”‘’'(\[\{]*)(.*)$/);
      if(!m) return line;
      const lead = m[1], rest = m[2];
      const i = rest.search(/[A-Za-z]/);
      if(i === -1) return line;
      return lead + rest.slice(0,i) + rest[i].toUpperCase() + rest.slice(i+1);
    }
    function toSentenceCase(text) {
      return text.split('\n').map(line => {
        const trimmed = line.trim();
        if (!trimmed) return line; // keep blank lines
        const lower = trimmed.toLowerCase();
        return sentenceCapLine(lower);
      }).join('\n');
    }

    // Capitalized Case (each word), preserving acronyms
    function toCapitalized(text) {
      return text.replace(/\b([A-Za-zÁ-ÿ]+)\b/g, (w) => {
        if (ACRONYMS.has(w) || ACRONYMS.has(w.toUpperCase())) return w.toUpperCase();
        return w[0].toUpperCase() + w.slice(1).toLowerCase();
      });
    }

    // Generic Title Case + AP Title Case
    const SMALL_WORDS = new Set(['a','an','the','and','but','or','nor','for','so','yet','as','at','by','in','of','on','per','to','via','from','over','into','onto','off','up','down','with','without']);
    function titleCaseCore(line, apMode=false){
        const tokens = line.split(/(\s+)/); // keep spaces
        let first=-1,last=-1;
        for(let i=0;i<tokens.length;i++) if(/\S/.test(tokens[i])){ first=i; break; }
        for(let i=tokens.length-1;i>=0;i--) if(/\S/.test(tokens[i])){ last=i; break; }

        let afterStrongSep=false; // after ":" or em dash, next word is strong
        return tokens.map((tok, idx)=>{
          if (!/\S/.test(tok)) return tok;

          const plain = tok.replace(/[^A-Za-zÁ-ÿ'.-]/g,'');
          const isAcr = ACRONYMS.has(plain) || ACRONYMS.has(plain.toUpperCase());

          // If the token is SHOUTING (ALL CAPS) but not an acronym, normalize to lower first
          const shouting = /^[A-Z][A-Z'.-]*$/.test(plain) && plain.length>1;
          const base = (shouting && !isAcr) ? plain.toLowerCase() : plain;

          const core = base.toLowerCase();
          const edge = (idx===first || idx===last) || afterStrongSep;

          // AP: verbs (even short ones) are always capped
          const shortVerb = /^(is|am|are|be|been|being|was|were|do|does|did|can|could|shall|should|will|would|may|might|must|has|have|had)$/.test(core);

          // AP small words rule: downcase short (≤3 letters) preps/conjs/articles in the middle
          const isSmall = SMALL_WORDS.has(core);
          const forceLower = !edge && (apMode ? (isSmall && core.length<=3 && !shortVerb) : isSmall);

          let out;
          if (forceLower) {
            out = core;
          } else {
            out = core.split('-').map((part,i)=>{
              if (!part) return part;
              if (apMode && i>0 && SMALL_WORDS.has(part) && part.length<=3) return part; // keep short hyphen parts lower
              return part[0].toUpperCase() + part.slice(1);
            }).join('-');
          }

          const rebuilt = tok.replace(plain, out);
          afterStrongSep = /[:—–-]$/.test(tok);
          return rebuilt;
        }).join('');
    }
    function toTitleCase(text) { return text.split('\n').map(l=>titleCaseCore(l,false)).join('\n'); }
    function toAPTitleCase(text) { return text.split('\n').map(l=>titleCaseCore(l,true)).join('\n'); }

    /* =========================
       DIALECT CONVERTER (UK↔US)
       Driven by your supplied list.
       ========================= */

    const USER_DIALECT_LIST = `
A
accessorise = accessorize
acclimatise = acclimatize
accoutrements = accouterments
aeon = eon
aerogramme = aerogram
aeroplane = airplane
aesthete = esthete
aesthetic = esthetic
aetiology = etiology
ageing = aging
aggrandisement = aggrandizement
agonise = agonize
almanack = almanac
aluminium = aluminum
amortisable = amortizable
amphitheatre = amphitheater
anaemia = anemia
anaesthesia = anesthesia
anaesthetise = anesthetize
analogue = analog
analyse = analyze
anglicise = anglicize
annualise = annualize
antagonise = antagonize
apologise = apologize
appal = appall
appetiser = appetizer
arbour = arbor
archaeological = archeological
ardour = ardor
armour = armor
artefact = artifact
authorise = authorize
axe = ax

B
backpedalling = backpedaling
bannister = banister
baptise = baptize
bastardise = bastardize
battle-axe = battleax
baulk = balk
bedevilled = bedeviled
behaviour = behavior
behove = behoove
bejewelled = bejeweled
belabour = belabor
bevelled = beveled
bevvy = bevy
bingeing = binging
bougainvillaea = bougainvillea
bowdlerise = bowdlerize
breathalyse = breathalyze
brutalise = brutalize
buses = busses

C
caesarean = cesarean
calibre = caliber
calliper = caliper
callisthenics = calisthenics
canalise = canalize
cancellation = cancelation
cancelled = canceled
candour = candor
cannibalise = cannibalize
canonise = canonize
capitalise = capitalize
caramelise = caramelize
carbonise = carbonize
carolling = caroling
catalogue = catalog
catalyse = catalyze
categorise = categorize
cauterise = cauterize
cavilling = caviling
centigramme = centigram
centilitre = centiliter
centimetre = centimeter
centralise = centralize
centre = center
centrefold = centerfold
centrepiece = centerpiece
channelling = channeling
characterise = characterize
cheque = check
chequebook = checkbook
chequered = checkered
chilli = chili
chimaera = chimera
chiselled = chiseled
circularise = circularize
civilise = civilize
clamour = clamor
clangour = clangor
clarinettist = clarinetist
collectivise = collectivize
colonise = colonize
colour = color
colourant = colorant
colourful = colorful
colourise = colorize
colourless = colorless
commercialise = commercialize
computerise = computerize
conceptualise = conceptualize
connexion = connection
contextualise = contextualize
cosier = cozier
cosy = cozy
counsellor = counselor
counselling = counseling
criminalise = criminalize
criticise = criticize
cruellest = cruelest
crystallisation = crystallization
cudgelling = cudgeling
customise = customize
cypher = cipher

D
decentralisation = decentralization
decriminalise = decriminalize
defence = defense
defenceless = defenseless
demeanour = demeanor
demilitarisation = demilitarization
demobilise = demobilize
democratise = democratize
demonise = demonize
demoralise = demoralize
denationalise = denationalize
deodorise = deodorize
depersonalise = depersonalize
deputise = deputize
desensitisation = desensitization
destabilise = destabilize
dialling = dialing
dialogue = dialog
diarrhoea = diarrhea
digitise = digitize
disc = disk
discolour = discolor
disembowelling = disemboweling
disfavour = disfavor
dishevelled = disheveled
dishonour = dishonor
disorganisation = disorganization
distil = distill
dramatising = dramatizing
draught = draft
draughtsman = draftsman
drivelling = driveling
duelled = dueled

E
economise = economize
edoema = edema
editorialise = editorialize
empathise = empathize
emphasise = emphasize
enamelled = enameled
enamoured = enamored
encyclopaedia = encyclopedia
endeavour = endeavor
energise = energize
enrol = enroll
enthral = enthrall
enquire = inquire
epaulette = epaulet
epicentre = epicenter
epilogue = epilog
epitomise = epitomize
equalisation = equalization
eulogise = eulogize
evangelise = evangelize
exorcise = exorcize
extemporisation = extemporization
exstemalisation = externalization
externalise = externalize

F
factorise = factorize
faecal = fecal
faeces = feces
familiarisation = familiarization
fantasise = fantasize
favour = favor
favourable = favorable
favourite = favorite
feminise = feminize
fertilise = fertilize
fervour = fervor
fibre = fiber
fictionalise = fictionalize
fillet = filet
finalise = finalize
flautist = flutist
flavour = flavor
foetal = fetal
foetid = fetid
foetus = fetus
formalise = formalize
fossilise = fossilize
fraternise = fraternize
fulfil = fulfill
fulfilment = fulfillment
funnelling = funneling

G
galvanise = galvanize
gambolling = gamboling
gaol = jail
gases = gasses
gauge = gage
generalise = generalize
ghettoise = ghettoize
glamorise = glamorize
glamour = glamor
globalise = globalize
glueing = gluing
goitre = goiter
gonorrhoea = gonorrhea
gramme = gram
gravelled = graveled
grey = gray
grovelled = groveled
gruelling = grueling
gryphon = griffon
gynaecological = gynecological

H
haematological = hematological
haemoglobin = hemoglobin
haemorrhage = hemorrhage
harbour = harbor
harmonise = harmonize
homoeopathy = homeopathy
homogenised = homogenized
honour = honor
hospitalise = hospitalize
humanise = humanize
humour = humor
hybridise = hybridize
hypnotise = hypnotize
hypothesise = hypothesize

I
idealise = idealize
idolise = idolize
immobilise = immobilize
immortalise = immortalize
immunise = immunize
impanelling = impaneling
imperilled = imperiled
individualise = individualize
industrialise = industrialize
inflexion = inflection
initialise = initialize
initialled = initialed
instal = install
instalment = installment
instil = instill
institutionalise = institutionalize
intellectualise = intellectualize
internalise = internalize
internationalise = internationalize
ionise = ionize
italicise = italicize
itemise = itemize

J
jeopardise = jeopardize
jewelled = jeweled
jewellery = jewelry
judgement = judgment

K
kilogramme = kilogram
kilometre = kilometer

L
labelled = labeled
labour = labor
lacklustre = lackluster
legalise = legalize
legitimise = legitimize
leukaemia = leukemia
leveller = leveler
libellous = libelous
liberalise = liberalize
licence = license
licencing = licensing
likeable = likable
lionise = lionize
liquidise = liquidize
litre = liter
localise = localize
lustre = luster

M
magnetise = magnetize
manoeuvre = maneuver
marginalise = marginalize
marshalling = marshaling
marvelled = marveled
marvellously = marvelously
materialise = materialize
maximise = maximize
meagre = meager
mechanise = mechanize
mediaeval = medieval
memorialise = memorialize
memorise = memorize
mesmerise = mesmerize
metabolise = metabolize
metre = meter
militarise = militarize
milligramme = milligram
millilitre = milliliter
miniaturise = miniaturize
minibuses = minibusses
minimise = minimize
misbehaviour = misbehavior
misdemeanour = misdemeanor
misspelt = misspelled
mitre = miter
mobilise = mobilize
modelled = modeled
modernise = modernize
moisturise = moisturize
monologue = monolog
monopolise = monopolize
moralise = moralize
motorise = motorize
mould = mold
moult = molt
moustache = mustache
multicoloured = multicolored
mum = mom

N
nationalise = nationalize
naturalise = naturalize
neighbour = neighbor
neighbourhood = neighborhood
neutralise = neutralize
normalise = normalize

O
odour = odor
oesophagus = esophagus
oestrogen = estrogen
offence = offense
omelette = omelet
optimise = optimize
organise = organize
orthopaedic = orthopedic
ostracise = ostracize
outmanoeuvre = outmaneuver
overemphasise = overemphasize
oxidise = oxidize

P
paederast = pederast
paediatrician = pediatrician
palaeolithic = paleolithic
palaeontologist = paleontologist
panelled = paneled
paralyse = paralyze
parcelled = parceled
parlour = parlor
particularise = particularize
passivise = passivize
pasteurise = pasteurize
patronise = patronize
pedalling = pedaling
pedestrianisation = pedestrianization
penalise = penalize
pencilling = penciling
personalise = personalize
pharmacopoeia = pharmacopeia
philosophise = philosophize
phoney = phony
plagiarise = plagiarize
plough = plow
polarise = polarize
politicise = politicize
popularise = popularize
practise = practice
practising = practicing
praesidium = presidium
pressurise = pressurize
pretence = pretense
primaeval = primeval
prioritise = prioritize
privatise = privatize
programme = program
prologue = prolog
propagandise = propagandize
proselytise = proselytize
psychoanalyse = psychoanalyze
publicise = publicize
pulverise = pulverize
pummelling = pummeling
pyjamas = pajamas
pzazz = pizzazz

Q
quarrelling = quarreling

R
radicalise = radicalize
rancour = rancor
randomise = randomize
rationalise = rationalize
ravelling = raveling
realise = realize
recognise = recognize
reconnoitre = reconnoiter
refuelled = refueled
regularise = regularize
remodelled = remodeled
remould = remold
reorganise = reorganize
revellers = revelers
revitalise = revitalize
revolutionise = revolutionize
rhapsodise = rhapsodize
rigour = rigor
ritualise = ritualize
rivalled = rivaled
romanticise = romanticize
rumour = rumor

S
sabre = saber
saltpetre = saltpeter
sanitise = sanitize
satirise = satirize
saviour = savior
savour = savor
scandalise = scandalize
sceptic = skeptic
sceptical = skeptical
sceptre = scepter
scrutinise = scrutinize
secularise = secularize
sensationalise = sensationalize
sensitised = sensitized
sentimentalise = sentimentalize
sepulchre = sepulcher
serialise = serialize
sermonise = sermonize
sheikh = sheik
shovelled = shoveled
shrivelled = shriveled
signalise = signalize
signalling = signaling
smoulder = smolder
snivelled = sniveled
snorkelled = snorkeled
snowplough = snowplow
socialise = socialize
solemnise = solemnize
sombre = somber
specialise = specialize
spectre = specter
spiralling = spiraling
splendour = splendor
squirrelling = squirreling
stabilise = stabilize
standardise = standardize
stencilling = stenciling
sterilise = sterilize
stigmatise = stigmatize
storey = story
subsidised = subsidized
succour = succor
sulphate = sulfate
sulphide = sulfide
sulphur = sulfur
summarise = summarize
swivelling = swiveling
symbolise = symbolize
sympathise = sympathize
synchronise = synchronize
synthesise = synthesize
syphon = siphon
systemise = systemize

T
tantalise = tantalize
tasselled = tasseled
technicolour = technicolor
temporise = temporize
tenderise = tenderize
terrorise = terrorize
theatre = theater
theorise = theorize
tonne = ton
towelling = toweling
toxaemia = toxemia
tranquillise = tranquilize
tranquilliser = tranquilizer
transistorise = transistorize
traumatise = traumatize
traveller = traveler
travelogue = travelog
trialling = trialing
tricolour = tricolor
trivialise = trivialize
tumour = tumor
tunnelling = tunneling
tyrannise = tyrannize
tyre = tire

U
unauthorised = unauthorized
uncivilised = uncivilized
underutilised = underutilized
unequalled = unequaled
unfavourable = unfavorable
unionise = unionize
unorganised = unorganized
unravelled = unraveled
unrecognised = unrecognized
unrivalled = unrivaled
unsavoury = unsavory
untrammelled = untrammeled
urbanise = urbanize
utilise = utilize

V
valour = valor
vandalise = vandalize
vaporise = vaporize
vapour = vapor
verbalise = verbalize
victimise = victimize
vigour = vigor
visualise = visualize
vocalise = vocalize
vulcanise = vulcanize
vulgarise = vulgarize

W
waggon = wagon
watercolour = watercolor
weaselled = weaseled
westernisation = westernization
womanise = womanize
woollen = woolen
worshipped = worshiped

Y
yodelling = yodeling
yoghurt = yogurt

A
Aeroplane = Airplane
Aluminium = Aluminum
Aubergine = Eggplant
Autumn = Fall

B
Barrister = Attorney
Bill = Check
Bin (for rubbish) = Trashcan
Biscuit = Cookie
Bloke/ Chap = Dude
Bonnet (of a car) = Hood
Booking = Reservation
Boot (of a car) = Trunk
Braces = Suspenders
Buggy (Push chair) = Stroller
Bum bag = Fanny pack

C
Candy floss = Cotton candy
Caravan = Trailer
Carpark = Parking lot
Cellar = Basement
Chemist = Drugstore
Cheque = Check
Chips = Fries
Cinema = Movie theater
Coach = Bus
Continuous tense = Progressive tense
Coriander = Cilantro
Courgette = Zucchini
Crisps = Chips
Curtains = Drapes

D
Dressing gown = Bathrobe
Dummy = Pacifier
Dustbin = Trashcan

E
Estate agency = Real estate agency
Estate car = Station wagon

F
Film = Movie
Fitted (past tense of to fit) = Fit
Flat = Apartment
Football = Soccer
Fringe = Bangs
Full stop = Period

G
Garden = Yard
Gearbox = Transmission
Gear lever = Stick shift
Ground floor = First floor

H
High street = Main street
Hob = Stovetop
Holiday = Vacation
Hoover = Vacuum cleaner

I
Ill = Sick
Insect = Bug
Inverted commas = Quotation marks

J
Jam = Jelly
Jelly = Jello
Jumper = Sweater
Junction = Intersection

L
Ladybird = Ladybug
Launderette = Laundromat
Lead (for dogs) = Leash
Lent (past of lend) = Loaned
Lift = Elevator
Loo = Bathroom
Love (endearment) = Honey
Lorry = Truck

M
Main road = Highway
Maths = Math
Mobile (phone) = Cellphone
Mobile home = Trailer
Motorway = Freeway/ Interstate
Mum = Mom

N
Nappy = Diaper
Note (Pound note) = Bill (Dollar bill)
Nought = Zero

P
Pants = Underpants
Pavement = Sidewalk
Pedestrian crossing = Crosswalk
Petrol = Gas
Plait = Braid
Plimsolls = Sneakers
Polo neck = Turtle neck
Pop/ Soft drinks = Soda
Porridge = Oatmeal
Post = Mail
Postcode = Zipcode
Pram = Baby carriage
Pub = Bar
Pudding = Sweet / Dessert

Q
Queue = Line

R
Railway = Railroad
Resign = Quit
Reverse charges = Collect call
Roundabout = Circle
Rubber = Eraser
Rubbish = Garbage/ Trash

S
Sack (to be sacked) = Fired
Settee/ Sofa = Couch
Shop = Store
Shopping Centre = Mall
Solicitor = Lawyer/ Attorney
Spanner = Wrench
Spat (past of spit) = Spit
Sunglasses = Shades
Sweets = Candy

T
Tap = Faucet
Telephone box = Phone booth
Term = Semester
Tin = Can
Torch = Flashlight
Trainers = Sneakers
Trolley (supermarket) = Cart
Trousers = Pants
Tube/ Underground = Subway
Tyre = Tire

V
Vest = Undershirt

W
Waistcoat = Vest
Wardrobe = Closet
Wellies = Rubber boots
Windscreen = Windshield
Wing mirror = Side mirror

Z
Zebra crossing = Crosswalk
Zip = Zipper
`;

    function buildDialectPairs(listStr){
      const corrections = new Map([
        ['plagiarze','plagiarize'],
        ['synchonize','synchronize'],
        ['pyschoanalyze','psychoanalyze'],
        ['exstemalisation','externalisation'],
        ['extemalization','externalization'],
        ['demobilze','demobilize'],
        ['destabilze','destabilize'],
        ['sterilze','sterilize'],
        ['chaneling','channeling'],
        ['out maneuver','outmaneuver'],
      ]);

      const rawPairs = [];
      listStr.split(/\r?\n/).forEach(line=>{
        const raw = line.trim();
        if(!raw || /^[A-Z]$/.test(raw) || raw.startsWith('//')) return;
        const m = raw.split('=');
        if(m.length!==2) return;

        let uk = m[0].trim().replace(/^\*+/,'');
        let us = m[1].trim();
        if(!uk || !us) return;

        uk = uk.replace(/\s+/g,' ').trim();
        us = us.replace(/\s+/g,' ').trim();

        const ukKey = uk.toLowerCase();
        const usKey = us.toLowerCase();
        if (corrections.has(usKey)) us = corrections.get(usKey);
        if (corrections.has(ukKey)) uk = corrections.get(ukKey);

        rawPairs.push([uk, us]);

        // Auto-derive common -ise/-ize inflections and -isation/-ization nouns
        if (uk.toLowerCase().endsWith('ise') && us.toLowerCase().endsWith('ize')) {
          const ru = uk.slice(0, -3); // drop "ise"
          const rs = us.slice(0, -3); // drop "ize"
          [
            ['ised','ized'], ['ises','izes'], ['ising','izing'],
            ['iser','izer'], ['isers','izers'],
            ['isation','ization'], ['isations','izations'],
            ['isational','izational'], ['isationally','izationally']
          ].forEach(([a,b]) => rawPairs.push([ru + a, rs + b]));
        }
      });

      // Deduplicate
      const seen = new Set();
      const pairs = [];
      for (const [a,b] of rawPairs) {
        const key = a.toLowerCase() + '→' + b.toLowerCase();
        if (!seen.has(key)) { seen.add(key); pairs.push([a,b]); }
      }
      return pairs;
    }

    const DIALECT_PAIRS = buildDialectPairs(USER_DIALECT_LIST);
    const UK2US_LIST = [...DIALECT_PAIRS].sort((a,b)=>b[0].length - a[0].length);
    const US2UK_LIST = [...DIALECT_PAIRS].map(([uk,us])=>[us,uk]).sort((a,b)=>b[0].length - a[0].length);

    function preserveCaseReplace(srcMatch, replacement){
      if (srcMatch === srcMatch.toUpperCase()) return replacement.toUpperCase();
      if (/^[A-Z][a-z]+(?:\s[A-Z][a-z]+)*$/.test(srcMatch)) {
        return replacement.replace(/\b([a-z])/g, m=>m.toUpperCase()).replace(/\B([A-Z][A-Z]+)/g, s=>s.toLowerCase());
      }
      return replacement.toLowerCase();
    }
    function phraseRegex(term){
      // Escape regex chars in a dictionary term
      const esc = term.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
      // Match start or non-alnum before, end or non-alnum after.
      // Use two groups so we can keep the leading separator intact.
      return new RegExp(`(^|[^A-Za-z0-9])(${esc})(?=$|[^A-Za-z0-9])`, 'gi');
    }
    function swapWithList(text, list){
      let out = text;
      for (const [from,to] of list){
        const re = phraseRegex(from);
        out = out.replace(re, (match, pre, hit) => pre + preserveCaseReplace(hit, to));
      }
      return out;
    }
    function swapUS2UK(text){ return swapWithList(text, US2UK_LIST); }
    function swapUK2US(text){ return swapWithList(text, UK2US_LIST); }

    // Ensure the buttons call the new functions
    document.getElementById('dialect-us').onclick = () => transformOutput(t => swapUK2US(t));
    document.getElementById('dialect-uk').onclick = () => transformOutput(t => swapUS2UK(t));

    // ----- Buttons (kept all your originals) -----
    $('#convert').addEventListener('click', convert);
    $('#copy').addEventListener('click', async () => {
      if (!outputEl.value) return;
      try { await navigator.clipboard.writeText(outputEl.value); flash('Copied!'); }
      catch { outputEl.select(); document.execCommand('copy'); flash('Copied!'); }
    });
    $('#download').addEventListener('click', () => {
      const blob = new Blob([outputEl.value || ""], { type: 'text/plain;charset=utf-8' });
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = 'cleaned_sentences.txt';
      document.body.appendChild(a); a.click(); a.remove();
      setTimeout(() => URL.revokeObjectURL(a.href), 1000);
    });
    $('#clear').addEventListener('click', () => { inputEl.value = ""; outputEl.value = ""; updateStats(""); });
    inputEl.addEventListener('input', () => { if (liveEl.checked) convert(); });

    // Hook up case tools
    $('#case-lower').addEventListener('click', () => transformOutput(toLower));
    $('#case-upper').addEventListener('click', () => transformOutput(toUpper));
    $('#case-inverse').addEventListener('click', () => transformOutput(toInverse));
    $('#case-alternating').addEventListener('click', () => transformOutput(toAlternating));
    $('#case-capitalized').addEventListener('click', () => transformOutput(toCapitalized));
    $('#case-sentence').addEventListener('click', () => transformOutput(toSentenceCase));
    $('#case-title').addEventListener('click', () => transformOutput(toTitleCase));
    $('#case-ap-title').addEventListener('click', () => transformOutput(toAPTitleCase));

    // Dialect buttons → new functions
    $('#dialect-us').addEventListener('click', () => transformOutput(t=>swapUK2US(t)));
    $('#dialect-uk').addEventListener('click', () => transformOutput(t=>swapUS2UK(t)));

    function flash(msg) {
      const b = document.createElement('div');
      b.textContent = msg;
      b.style.position='fixed'; b.style.right='16px'; b.style.bottom='16px';
      b.style.background='rgba(77,163,255,.95)'; b.style.color='#00142a';
      b.style.padding='10px 14px'; b.style.borderRadius='10px'; b.style.fontWeight='700';
      b.style.boxShadow='0 6px 30px rgba(0,0,0,.35)';
      document.body.appendChild(b);
      setTimeout(()=>b.remove(), 1200);
    }

    // Initialize stats on load
    updateStats("");
  </script>
</body>
</html>